<?xml version="1.0" encoding="UTF-8"?>
<profile>
    <name>mu_ni</name>
    <description>Portal-Profile Geoportal.WSV</description>
    <pages>
        <page>
            <name>main-service.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>main-features.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>main-environment.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>main-maps.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>main-chronicle.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>main-measures.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>main-about.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>mdek/mdek_portal_admin.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>search-catalog/search-catalog-hierarchy.psml</name>
            <hidden>true</hidden>
        </page>
        <page>
            <name>application/main-application.psml</name>
            <hidden>false</hidden>
        </page>
        <page>
            <name>default-page.psml</name>
            <hidden>false</hidden>
            <portlets>
                <portlet col="0" row="0">
                    <name>ingrid-portal-apps::SearchSimple</name>
                </portlet>
                <portlet col="0" row="1">
                    <name>ingrid-portal-apps::ShortcutSearchQueryPortlet</name>
                </portlet>
                <portlet col="0" row="2">
                    <name>ingrid-portal-apps::RssNewsTeaser</name>
                </portlet>
                <portlet col="0" row="3">
                    <name>ingrid-portal-apps::IngridWelcomePortlet</name>
                </portlet>
                <portlet col="1" row="0">
                    <name>ingrid-portal-apps::IngridInformPortlet</name>
                </portlet>
                <portlet col="1" row="1">
                    <name>ingrid-portal-apps::ShortcutTeaser</name>
                </portlet>
            </portlets>
        </page>
        <page>
            <name>_role/user/default-page.psml</name>
            <hidden>false</hidden>
            <portlets>
                <portlet col="0" row="0">
                    <name>ingrid-portal-apps::SearchSimple</name>
                </portlet>
                <portlet col="0" row="1">
                    <name>ingrid-portal-apps::ShortcutSearchQueryPortlet</name>
                </portlet>
                <portlet col="0" row="2">
                    <name>ingrid-portal-apps::RssNewsTeaser</name>
                </portlet>
                <portlet col="0" row="3">
                    <name>ingrid-portal-apps::IngridWelcomePortlet</name>
                </portlet>
                <portlet col="1" row="0">
                    <name>ingrid-portal-apps::IngridInformPortlet</name>
                </portlet>
                <portlet col="1" row="1">
                    <name>ingrid-portal-apps::ShortcutTeaser</name>
                </portlet>
            </portlets>
        </page>
        <page>
            <name>_user/template/default-page.psml</name>
            <hidden>false</hidden>
            <portlets>
                <portlet col="0" row="0">
                    <name>ingrid-portal-apps::SearchSimple</name>
                </portlet>
                <portlet col="0" row="1">
                    <name>ingrid-portal-apps::ShortcutSearchQueryPortlet</name>
                </portlet>
                <portlet col="0" row="2">
                    <name>ingrid-portal-apps::RssNewsTeaser</name>
                </portlet>
                <portlet col="0" row="3">
                    <name>ingrid-portal-apps::IngridWelcomePortlet</name>
                </portlet>
                <portlet col="1" row="0">
                    <name>ingrid-portal-apps::IngridInformPortlet</name>
                </portlet>
                <portlet col="1" row="1">
                    <name>ingrid-portal-apps::ShortcutTeaser</name>
                </portlet>
            </portlets>
        </page>
    </pages>
    <files>
        <file>
            <action>copy-dir</action>
            <src>ingrid-portal/</src>
        </file>
        <file>
            <action>copy-dir</action>
            <src>ingrid-portal-apps/</src>
        </file>
    </files>
    <sql>
    	<!-- PortalU informiert -->
        <execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='<span style=\'text-transform: none;\'>Geoportal.WSV Informiert</span>'\, item_value='Geoportal.WSV Informiert Inhalt' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.teaser.inform') AND item_lang='de';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='<span style=\'text-transform: none;\'>Geoportal.WSV Inform</span>'\, item_value='Geoportal.WSV Informiert Content' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.teaser.inform') AND item_lang='en';]]>
        </execute>    
        <!-- Shortcut -->
        <execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Anwendung'\, item_value='<div><ul class=\"shortcut\"><li><a href=\"/visualist\" title=\"VisuaList\"><div><img src=\"/ingrid-portal-apps/images/features/tab_topic.png\"><p>VisuaList</p></div></a></li><li><a href=\"/wms2go\" title=\"GeoViewer\"><div><img src=\"/ingrid-portal-apps/images/features/tab_topic.png\"><p>GeoViewer</p></div></a></li><li><a href=\"/bwastr\" title=\"GeoKatalog.WSV\"><div><img src=\"/ingrid-portal-apps/images/features/tab_measures.png\"><p>GeoKatalog.WSV</p></div></a></li><li><a href=\"/bwastr\" title=\"ArcGIS\"><div><img src=\"/ingrid-portal-apps/images/features/tab_service.png\"><p>ArcGIS</p></div></a></li><li><a href=\"/bwastr\" title=\"Weiter GIS-Tools\"><div><img src=\"/ingrid-portal-apps/images/features/tab_catalog.png\"><p>Weitere GIS-Tools</p></div></a></li></ul></div>' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portal.teaser.shortcut') AND item_lang='de';]]>
        </execute>    
        <execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Application'\, item_value='<div><ul class=\"shortcut\"><li><a href=\"/visualist\" title=\"VisuaList\"><div><img src=\"/ingrid-portal-apps/images/features/tab_topic.png\"><p>VisuaList</p></div></a></li><li><a href=\"/wms2go\" title=\"GeoViewer\"><div><img src=\"/ingrid-portal-apps/images/features/tab_topic.png\"><p>GeoViewer</p></div></a></li><li><a href=\"/bwastr\" title=\"GeoKatalog.WSV\"><div><img src=\"/ingrid-portal-apps/images/features/tab_measures.png\"><p>GeoKatalog.WSV</p></div></a></li><li><a href=\"/bwastr\" title=\"ArcGIS\"><div><img src=\"/ingrid-portal-apps/images/features/tab_service.png\"><p>ArcGIS</p></div></a></li><li><a href=\"bwastr\" title=\"Weiter GIS-Tools\"><div><img src=\"/ingrid-portal-apps/images/features/tab_catalog.png\"><p>Weitere GIS-Tools</p></div></a></li></ul></div>' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portal.teaser.shortcut') AND item_lang='en';]]>
        </execute>    
        <!-- Shortcut Query -->
        <execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Schnellsuche'\, item_value='<ul class="catalog">\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=wasser&ds=1&grouping=domain">Wasser</a><span class="separator"> </span></li>\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=boden&ds=1&grouping=domain">Boden</a><span class="separator"> </span></li>\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=vögel&ds=1&grouping=domain">Vögel</a><span class="separator"> </span></li>\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=meer&ds=1&grouping=domain">Meer</a></li>\r\n\r\n</ul>' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portal.teaser.shortcut.query') AND item_lang='de';]]>
        </execute>    
        <execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Quick Search'\, item_value='<ul class="catalog">\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=water&ds=1&grouping=domain">water</a><span class="separator"> </span></li>\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=soil&ds=1&grouping=domain">soil</a><span class="separator"> </span></li>\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=birds&ds=1&grouping=domain">birds</a><span class="separator"> </span></li>\r\n\r\n<li><a href="/freitextsuche?action=doSearch&q=ocean&ds=1&grouping=domain">ocean</a>\r\n\r\n</ul>' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portal.teaser.shortcut.query') AND item_lang='en';]]>
        </execute>    
        <!-- Webmaster -->
		<execute>
            <![CDATA[UPDATE LINK SET URL='mailto:bscwadministrator@ilmenau.baw.de' WHERE NAME='webmaster.link';]]>
        </execute>
        <!-- Impressum -->
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Impressum'\, item_value='Impressum Inhalt' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.disclaimer') AND item_lang='de';]]>
        </execute>
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Disclaimer'\, item_value='Disclaimer Content' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.disclaimer') AND item_lang='en';]]>
        </execute>
		<!-- Datenschutz-->
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Datenschutz'\, item_value='Datenschutz - Inhalt' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.privacy') AND item_lang='de';]]>
        </execute>
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Privacy Policy'\, item_value='Privacy Policy -Content' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.privacy') AND item_lang='en';]]>
        </execute>
		<!-- Willkommen-->
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Willkommen bei Geoportal.WSV'\, item_value='Willkommen bei Geoportal.WSV - Inhalt' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='ingrid.home.welcome') AND item_lang='de';]]>
        </execute>
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_title='Welcome to Geoportal.WSV'\, item_value='Welcome to Geoportal.WSV - Content' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='ingrid.home.welcome') AND item_lang='en';]]>
        </execute>
		<!-- Kontaktseite-->
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_value='Kontakte - Inhalt' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.contact.intro.postEmail') AND item_lang='de';]]>
        </execute>
		<execute>
            <![CDATA[UPDATE ingrid_cms_item SET item_value='Contact - Content' WHERE fk_ingrid_cms_id = (SELECT id FROM ingrid_cms WHERE item_key='portalu.contact.intro.postEmail') AND item_lang='en';]]>
        </execute>
        <!-- Use old templates for info portlet -->
       	<execute>
            <![CDATA[UPDATE fragment_pref_value SET value='/WEB-INF/templates/chronicle_info.vm' WHERE value='/WEB-INF/templates/chronicle_info_new.vm';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment_pref_value SET value='/WEB-INF/templates/environment_info.vm' WHERE value='/WEB-INF/templates/environment_info_new.vm';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment_pref_value SET value='/WEB-INF/templates/measures_info.vm' WHERE value='/WEB-INF/templates/measures_info_new.vm';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment_pref_value SET value='/WEB-INF/templates/service_info.vm' WHERE value='/WEB-INF/templates/service_info_new.vm';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment_pref_value SET value='/WEB-INF/templates/search_simple_info.vm' WHERE value='/WEB-INF/templates/search_simple_info_new.vm';]]>
        </execute>
        <!-- Set decorator to ingrid-marginal-teaser -->
        <execute>
            <![CDATA[CREATE TABLE IF NOT EXISTS `tmp_table` (`id` bigint(20) NOT NULL AUTO_INCREMENT\, `item_key` varchar(255) COLLATE latin1_general_ci DEFAULT NULL\, `item_value` varchar(255) COLLATE latin1_general_ci DEFAULT NULL\, `item_date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP\, PRIMARY KEY (`id`));]]>
        </execute>
        <execute>
            <![CDATA[INSERT INTO tmp_table (`item_key`\, `item_value`) values ('tmp_id'\, '0');]]>
        </execute>
        <execute>
            <![CDATA[UPDATE tmp_table SET `item_value` = (SELECT fragment_id FROM fragment WHERE page_id = (SELECT page_id FROM page WHERE path = '/main-chronicle.psml')) WHERE `item_key`='tmp_id';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment SET decorator='ingrid-marginal-teaser' WHERE parent_id = (SELECT item_value FROM tmp_table WHERE item_key = 'tmp_id') AND name = 'ingrid-portal-apps::InfoPortlet';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE tmp_table SET `item_value` = (SELECT fragment_id FROM fragment WHERE page_id = (SELECT page_id FROM page WHERE path = '/main-measures.psml')) WHERE `item_key`='tmp_id';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment SET decorator='ingrid-marginal-teaser' WHERE parent_id = (SELECT item_value FROM tmp_table WHERE item_key = 'tmp_id') AND name = 'ingrid-portal-apps::InfoPortlet';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE tmp_table SET `item_value` = (SELECT fragment_id FROM fragment WHERE page_id = (SELECT page_id FROM page WHERE path = '/main-environment.psml')) WHERE `item_key`='tmp_id';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment SET decorator='ingrid-marginal-teaser' WHERE parent_id = (SELECT item_value FROM tmp_table WHERE item_key = 'tmp_id') AND name = 'ingrid-portal-apps::InfoPortlet';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE tmp_table SET `item_value` = (SELECT fragment_id FROM fragment WHERE page_id = (SELECT page_id FROM page WHERE path = '/main-service.psml')) WHERE `item_key`='tmp_id';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment SET decorator = 'ingrid-marginal-teaser' WHERE parent_id = (SELECT item_value FROM tmp_table WHERE item_key = 'tmp_id') AND name = 'ingrid-portal-apps::InfoPortlet';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE tmp_table SET `item_value` = (SELECT fragment_id FROM fragment WHERE page_id = (SELECT page_id FROM page WHERE path = '/main-search.psml')) WHERE `item_key`='tmp_id';]]>
        </execute>
        <execute>
            <![CDATA[INSERT INTO ingrid_lookup (`item_key`\, `item_value`) values ('tmp_id'\, '0');]]>
        </execute>
        <execute>
            <![CDATA[UPDATE ingrid_lookup SET `item_value` = (SELECT fragment_id FROM fragment WHERE parent_id = (SELECT item_value FROM tmp_table WHERE item_key = 'tmp_id') AND name = 'jetspeed-layouts::IngridTwoColumns') WHERE `item_key`='tmp_id';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE fragment SET decorator = 'ingrid-marginal-teaser' WHERE parent_id = (SELECT item_value FROM ingrid_lookup WHERE item_key = 'tmp_id') AND name = 'ingrid-portal-apps::InfoPortlet';]]>
        </execute>
        <execute>
            <![CDATA[DELETE FROM ingrid_lookup WHERE item_key = 'tmp_id';]]>
        </execute>
        <!-- Revert feature page as default for about page -->
        <execute>
            <![CDATA[UPDATE tmp_table SET `item_value` = (SELECT menu_id FROM folder_menu WHERE name = 'main-menu') WHERE `item_key`='tmp_id';]]>
        </execute>
        <execute>
            <![CDATA[UPDATE folder_menu SET OPTIONS = '/main-about.psml' WHERE OPTIONS = '/main-features.psml' AND parent_id  = (SELECT item_value FROM tmp_table WHERE item_key = 'tmp_id') ;]]>
        </execute>
        <execute>
            <![CDATA[DROP TABLE tmp_table;]]>
        </execute>
        <execute>
            <![CDATA[UPDATE page SET title = 'ingrid.page.features.tooltip'\, short_title = 'ingrid.page.features' WHERE path = '/main-features.psml';]]>
        </execute>
    </sql>
</profile>
