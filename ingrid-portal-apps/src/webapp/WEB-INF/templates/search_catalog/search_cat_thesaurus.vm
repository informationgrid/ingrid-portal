#macro (renderNode $node)
	## NOTICE: NO FLOATS IN VELOCITY MATHs ! Use e.g. (3/2) instead ! :-(
	#set ($leftMargin = ($node.level - 1) * 25)
	#set ($iconLayerWidth = 40)
	#set ($textLayerWidth = 870 - $leftMargin - $iconLayerWidth)
    
	#set ($action = $renderResponse.createActionURL())
	$action.setParameter('topicID',$node.get("topicID"))
	$action.setParameter('nodeId',$node.id)
	<p style="margin-left:${leftMargin}px; clear:left; overflow:hidden">	
	## render +/- and icon
	#set($nodeIcon = "ico_tree_folder_close.gif")
	#set($nodeAlt = "$MESSAGES.getString('common.alt.icon.folder')")

	#if($node.isOpen())
		#set ($renderSubNodes = true)
		## render "-" and icon WITH ACTION -> node can be closed
		$action.setParameter('action','doCloseNode')
		<a href="$action"><img src="/ingrid-portal-apps/images/ico_tree_open.gif" alt="$MESSAGES.getString('common.alt.icon.minus')" /></a>
   		<a href="$action"><img src="/ingrid-portal-apps/images/$nodeIcon" alt="$nodeAlt" title="$nodeAlt" /></a>
	#else
		#set ($renderSubNodes = false)
		#if ($node.expandable)
			## render "+" and icon WITH ACTION -> node not opened yet and can be expanded 
			$action.setParameter('action','doOpenNode')
			<a href="$action"><img src="/ingrid-portal-apps/images/ico_tree_close.gif" alt="$MESSAGES.getString('common.alt.icon.plus')" /></a>
   		<a href="$action"><img src="/ingrid-portal-apps/images/$nodeIcon" alt="$nodeAlt" title="$nodeAlt" /></a>
		#else
			## render " " and icon WITHOUT ACTION -> node can't be expanded
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		#end
	#end


	## render node text differently depending on the type and if it's currently selected
	$action.setParameter('action','doSearch')
    ##	<a href="$action">$node.name (Node Level: $node.level, numChildren: $node.getChildren().size())</a>
	#if ($node.type == 0) ## TopTerm Type
	    <strong>$node.name</strong>
	#elseif ($node.type == 1) ## NodeLabel Type
	    <strong>$node.name</strong>
	#elseif ($node.type == 2) ## Descriptor Type
	  #if ($node.name == $ps.currentQueryTerm)
	    <strong><a href="$action"><span style="text-decoration:underline">$node.name</span></a></strong>
	  #else
	    <strong><a href="$action">$node.name</a></strong>
	  #end
	#else
		<strong>$node.name</strong>
	#end
	</p>

	#if ($renderSubNodes)
		#foreach($childNode in $node.getChildren())
			#renderNode($childNode)
		#end
	#end
#end

<div class="section">    
  #parse ('/WEB-INF/templates/search_catalog/include_tabs_cat.vm')
  #parse ('/WEB-INF/templates/search_catalog/include_tabs_cat_thesaurus.vm')
  <div class="formbody">
	#foreach($termNode in $ps.thesRoot.getChildren())
	  #renderNode($termNode)
    #end
  </div>
  #set ($action = $renderResponse.createActionURL())
  <form action="$action" method="post" enctype="" name="extsearch" id="extsearch">
    <div class="formfooter">
      <div align="right">
        <input class="btn" type="submit" name="submitReload" value="$MESSAGES.getString('searchCatHierarchy.submit.reload')" />
      </div>
    </div>
  </form>
</div>