<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de">
<head>
<title>InGrid-Editor</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="author" content="wemove digital solutions" />
<meta name="copyright" content="wemove digital solutions GmbH" />

<script src='/ingrid-portal-mdek-application/dwr/interface/QueryService.js'></script>
<script src='/ingrid-portal-mdek-application/dwr/engine.js'></script>

<script type="text/javascript">
var tempStr = window.location.search;
var query = tempStr.substring(tempStr.indexOf("query=")+6, tempStr.length);

QueryService.queryHQLToCSV(query, {
	callback: function(data) {
		var iframe = document.createElement("iframe");
		iframe.src = data;
		iframe.style.display = "none";
		document.body.appendChild(iframe);

		hideLoadingZone();
		showCloseWindowMessage();
	},
	errorHandler: function(errMsg) {
		alert("Beim bearbeiten der Anfrage ist folgender Fehler aufgetreten: "+errMsg);
		window.setTimeout("window.close()", 1000);
	}		
});

function hideLoadingZone() {
	document.getElementById("loadingZone").style.display = "none";
}

function showCloseWindowMessage() {
	document.getElementById("closeWindow").style.display = "block";
}
</script>

</head>

<body>
<span id="closeWindow" style="display:none;">
Der Download wird gestartet, das Fenster kann jetzt geschlossen werden.
</span>
<span id="loadingZone">
	<img id="imageZone" src="img/ladekreis.gif" style="background-color:#FFFFFF;" />
	Bitte warten, die Anfrage wird bearbeitet...
</span>
</body>
</html>