<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de">
<head>

<style type="text/css">
/* If the select box (AND/OR select) is opened for the first time a scrollbar is shown for the main tab.
   to prevent this behaviour, the overflow is made invisible */
div.dojoTabPaneWrapper { overflow:visible; }
</style>


<script type="text/javascript">
var scriptScope = this;

var resultsPerPage = 10;
var pageNav = new PageNavigation({ resultsPerPage: resultsPerPage, infoSpan:dojo.byId("objSearchExtResultsInfo"), pagingSpan:dojo.byId("objSearchExtResultsPaging") });

var currentQuery = {	// Map of strings defining the query. See 'ObjectExtSearchParamsBean.java' for more details.
	queryTerm: null,			// search query
	relation: null,				// relation that should be used to analyze the query (AND / OR)
	objClasses: null,			// array of ints that represent the object classes that should be included in the search
	thesaurusTerms: null,		// array of topicIds - descriptors and non-descriptors
	thesaurusRelation: null,	// relation that should be used to combine the thesaurus terms (AND / OR)
	geoThesaurusTerms: null,	// array of areaIds - locations
	geoThesaurusRelation: null,	// relation that should be used to combine the location topics (AND / OR)
	customLocation: null,		// custom location id from the catalog
	timeBegin: null,			// Time reference. Date object begin.
	timeEnd: null,				// Time reference. Date object end.
	timeAt: null,				// Time reference. Date object.
	timeIntersects: null,		// Flag signaling if the entered interval should be cut by the result 
	timeContains: null			// Flag signaling if the entered interval should be included in the result
}


_container_.addOnLoad(function() {
	// Initially select the first tabs on load
	scriptScope.navInnerTab('objTopic', 0, 3);
	scriptScope.navInnerTab('objSpace', 0, 3);
	scriptScope.navInnerTab('objTime', 0, 1);

	// Initialize select boxes
	dojo.widget.byId("objTopicInputBool").setValue(0);
	dojo.widget.byId("thesaurusTermsRelation").setValue(0);
	dojo.widget.byId("geoThesaurusTermsRelation").setValue(0);

	// Init the 'custom location' select box 
//           listId="1100" id="objSpaceGeoUnit"
	var languageCode = UtilCatalog.getCatalogLanguage();

	CatalogService.getSysLists([1100], languageCode, {
		callback: function(res) {
			dojo.widget.byId("objSpaceGeoUnit").dataProvider.setData(res[1100]);
		},
		errorHandler: function(mes) {
			dojo.debug("Error: "+mes);
		}
	});

    // Pressing 'enter' on the queryTerm field is equal to 'start search'
    dojo.event.connect(dojo.widget.byId("objTopicInput").domNode, "onkeypress",
        function(event) {
            if (event.keyCode == event.KEY_ENTER) {
                scriptScope.startNewSearch();
            }
	});

    // Pressing 'enter' on the thesaurus input field is equal to a button click
    dojo.event.connect(dojo.widget.byId("objTopicThesaurus").domNode, "onkeypress",
        function(event) {
            if (event.keyCode == event.KEY_ENTER) {
                scriptScope.findTopics();
            }
	});

    // Pressing 'enter' on the thesaurus input field is equal to a button click
    dojo.event.connect(dojo.widget.byId("objLocationTopic").domNode, "onkeypress",
        function(event) {
            if (event.keyCode == event.KEY_ENTER) {
                scriptScope.findLocationTopics();
            }
	});

    // Pressing 'enter' on the time input fields is equal to a button click
    dojo.event.connect(dojo.widget.byId("objTimeRef1From").domNode, "onkeypress",
        function(event) {
			dojo.byId("objTimeRef1").checked = true;
            if (event.keyCode == event.KEY_ENTER) {
                scriptScope.startNewSearch();
            }
	});
    dojo.event.connect(dojo.widget.byId("objTimeRef1To").domNode, "onkeypress",
        function(event) {
			dojo.byId("objTimeRef1").checked = true;
            if (event.keyCode == event.KEY_ENTER) {
                scriptScope.startNewSearch();
            }
	});
    dojo.event.connect(dojo.widget.byId("objTimeRef2On").domNode, "onkeypress",
        function(event) {
			dojo.byId("objTimeRef2").checked = true;
            if (event.keyCode == event.KEY_ENTER) {
                scriptScope.startNewSearch();
            }
	});

	// Pressing one of the radio buttons deletes the 'other' input fields
    dojo.byId("objTimeRef1").onclick = function() {
		dojo.widget.byId("objTimeRef2On").clearValue();
    }
    dojo.byId("objTimeRef2").onclick = function() {
		dojo.widget.byId("objTimeRef1From").clearValue();
		dojo.widget.byId("objTimeRef1To").clearValue();
    }
    dojo.byId("objTimeRef3").onclick = function() {
		dojo.widget.byId("objTimeRef2On").clearValue();
		dojo.widget.byId("objTimeRef1From").clearValue();
		dojo.widget.byId("objTimeRef1To").clearValue();
    }

	dojo.event.connect("after", pageNav, "onPageSelected", function() { startSearch(); });
});

// ************************** General Search functions **************************

// Starts a search with the current parameters stored in 'currentQuery' and 'pageNav'
function startSearch() {
	QueryService.queryObjectsExtended(currentQuery, pageNav.getStartHit(), resultsPerPage, {
		preHook: showLoadingZone,
		postHook: hideLoadingZone,
		callback: function(res) { updateResultTable(res); updatePageNavigation(res); },
		errorHandler: function(errMsg, err) {
			displayErrorMessage(err);
		}		
	});
}

function updateResultTable(res) {
//	dojo.debugShallow(res);
	var resultList = res.resultList;
	UtilList.addObjectLinkLabels(resultList);  
	UtilList.addTableIndices(resultList);
	UtilList.addIcons(resultList);

	dojo.widget.byId("objectSearchExtResults").store.setData(resultList);
}

function updatePageNavigation(res) {
	pageNav.setTotalNumHits(res.totalNumHits);
	pageNav.updateDomNodes();
}


// Search button function. Creates a new query and starts a new search
this.startNewSearch = function() {
	readQueryFromInput();
	pageNav.reset();
	startSearch();
}


// Subnavigation. 'subSectionIndex' specifies the index of the tab that should be selected
this.navInnerTab = function(sectionName, subSectionIndex, numSubSections){

	for (var i = 0; i < numSubSections; i++) {
		if (i == subSectionIndex) {
			dojo.byId(sectionName + i).style.display = "block";
		} else {
			dojo.byId(sectionName + i).style.display = "none";
		}
	}
}

// Read the input fields and write the query to 'currentQuery'
function readQueryFromInput() {
	currentQuery.queryTerm = dojo.string.trim(dojo.widget.byId("objTopicInput").getValue());
	currentQuery.relation = dojo.widget.byId("objTopicInputBool").getValue();
	// Read obj class checkboxes
	currentQuery.objClasses = [];
	for (var i = 0; i < 6; ++i) {
		if (dojo.widget.byId("objTopicObjectClass" + i).checked)
			currentQuery.objClasses.push(i);
	}

	// Read the Descriptors from the thesaurus table
	var descStore = dojo.widget.byId("objExtSearchThesaurusTerms").store;
	currentQuery.thesaurusTerms = [];
	dojo.lang.forEach(descStore.getData(), function(item){
		currentQuery.thesaurusTerms.push(item.topicId);
	});
	currentQuery.thesaurusRelation = dojo.widget.byId("thesaurusTermsRelation").getValue();

	// Read the Location topics from the thesaurus table
	var geoThesStore = dojo.widget.byId("objExtSearchLocationTerms").store;
	currentQuery.geoThesaurusTerms = [];
	dojo.lang.forEach(geoThesStore.getData(), function(item){
		currentQuery.geoThesaurusTerms.push(item.topicId);
	});
	currentQuery.geoThesaurusRelation = dojo.widget.byId("geoThesaurusTermsRelation").getValue();

	currentQuery.customLocation = dojo.widget.byId("objSpaceGeoUnit").getValue();

	// Time ref
	currentQuery.timeBegin = null;
	currentQuery.timeEnd = null;
	currentQuery.timeAt = null;

	if (dojo.byId("objTimeRef1").checked) {
		// 'From-To' checked
		currentQuery.timeBegin = dojo.widget.byId("objTimeRef1From").getValue();
		currentQuery.timeEnd = dojo.widget.byId("objTimeRef1To").getValue();
/*
//		Text input fields
		currentQuery.timeBegin = dojo.date.parse(dojo.widget.byId("objTimeRef1From").getValue(), {formatLength:"full", datePattern:'dd.MM.yyyy', selector:'dateOnly'});
		currentQuery.timeEnd = dojo.date.parse(dojo.widget.byId("objTimeRef1To").getValue(), {formatLength:"full", datePattern:'dd.MM.yyyy', selector:'dateOnly'});
*/

	} else if (dojo.byId("objTimeRef2").checked) {
		// 'At' checked
		currentQuery.timeAt = dojo.widget.byId("objTimeRef2On").getValue();

//		Text input field
//		currentQuery.timeAt = dojo.date.parse(dojo.widget.byId("objTimeRef2On").getValue(), {formatLength:"full", datePattern:'dd.MM.yyyy', selector:'dateOnly'});
	}

	currentQuery.timeIntersects = dojo.widget.byId("objTimeRefExtend1").checked;
	currentQuery.timeContains = dojo.widget.byId("objTimeRefExtend2").checked;

	dojo.debugShallow(currentQuery);
}

// Reset-Button function. Reset all the input fields to their initial values and reset 'currentQuery'
this.resetInput = function() {
	dojo.widget.byId("objTopicInput").setValue("");
	dojo.widget.byId("objTopicInputBool").setValue(0);
	scriptScope.selectAllObjectClasses();
	dojo.widget.byId("objTopicThesaurus").setValue("");
	dojo.widget.byId("objExtSearchThesaurusTerms").store.clearData();
	dojo.widget.byId("thesaurusTermsRelation").setValue(0);
	dojo.widget.byId("objLocationTopic").setValue("");
	dojo.widget.byId("objExtSearchLocationTerms").store.clearData();
	dojo.widget.byId("geoThesaurusTermsRelation").setValue(0);
	dojo.widget.byId("objSpaceGeoUnit").setValue("");
	dojo.byId("objTimeRef1").checked = false;
	dojo.byId("objTimeRef2").checked = false;
	dojo.byId("objTimeRef3").checked = true;

	dojo.widget.byId("objTimeRef1From").clearValue();
	dojo.widget.byId("objTimeRef1To").clearValue();
	dojo.widget.byId("objTimeRef2On").clearValue();

/*
	// Text input fields 
	dojo.widget.byId("objTimeRef1From").setValue("");
	dojo.widget.byId("objTimeRef1To").setValue("");
	dojo.widget.byId("objTimeRef2On").setValue("");
*/
	dojo.widget.byId("objTimeRefExtend1").setValue(false);
	dojo.widget.byId("objTimeRefExtend2").setValue(false);

	readQueryFromInput();
}


// ************************** Thesaurus Search functions (Thema/fachwoerterbuch) **************************

// Button function which searches for descriptors/nondescriptors from a given search query
// A list of checkboxes/labels is created and put into the div with id: 'objExtSearchThesaurusResults'
this.findTopics = function() {
	var term = dojo.string.trim(dojo.widget.byId("objTopicThesaurus").getValue());

	// Exit if we search for an empty string
	if (term.length == 0) {
		return;
	}

	clearThesaurusResults();

	SNSService.findTopics(term, {
		preHook: showLoadingZone,
		postHook: hideLoadingZone,
		callback:function(topics) {
			if (dojo.lang.some(topics, function(item) { return item.type == "DESCRIPTOR"} )) {
				addResultTextElement("\u00c4hnliche Begriffe");
				dojo.lang.forEach(topics, function(item){
	//				if (item.type == "DESCRIPTOR" || item.type == "NON_DESCRIPTOR") {
					if (item.type == "DESCRIPTOR") {
						addDescriptorCheckbox(item);
					}
				});
				dojo.html.show(dojo.byId("objExtSearchAddTopicButtonSpan"));

			} else {
				showNoThesaurusResults();
			}
		},
		timeout:20000,
		errorHandler:function(err) {
			hideLoadingZone();
			dojo.debug("Error while executing SNSService.findTopics");
		}
	});
}

this.addSelectedTopics = function() {
	var resultDiv = dojo.byId("objExtSearchThesaurusResults");
	var resultStore = dojo.widget.byId("objExtSearchThesaurusTerms").store;

	dojo.lang.forEach(resultDiv.childNodes, function(divElement) {
		var checkBoxDiv = divElement.firstChild;
		if (checkBoxDiv && checkBoxDiv.id) {
			var checkBox = dojo.widget.byId(checkBoxDiv.id);
		} else {
			return;
		}

		if (checkBox.checked) {
			// If the checked item is already contained in the result list then do nothing
			if (dojo.lang.some(resultStore.getData(), function(item){ return (checkBox.id == item.topicId); }))
				return;

			// Otherwise add the item to the result list
			resultStore.addData( {Id: UtilStore.getNewKey(resultStore), topicId: checkBox.id, title: checkBox.name} );
		}
	});
}

function addDescriptorCheckbox(descriptor, disableLink) {
	var resultDiv = dojo.byId("objExtSearchThesaurusResults");

	var checkBox = dojo.widget.createWidget("checkbox", {
			id: descriptor.topicId,
			name: descriptor.title
		});

	var divElement = document.createElement("div");

	if (disableLink) {
		var labelElement = document.createTextNode(descriptor.title);
		resultDiv.appendChild(divElement);
		divElement.appendChild(checkBox.domNode);
		divElement.appendChild(labelElement);
		return;
	}

	var linkElement = document.createElement("a"); 
	linkElement.setAttribute("href", "javascript:void(0);");
	linkElement.descriptor = descriptor;
	linkElement.onclick = function() {
		findAssociatedTopics(this.descriptor);
	}
	linkElement.innerHTML = descriptor.title;

	resultDiv.appendChild(divElement);
	divElement.appendChild(checkBox.domNode);
//	divElement.appendChild(labelElement);
	divElement.appendChild(linkElement);
}

function addResultTextElement(text) {
	var resultDiv = dojo.byId("objExtSearchThesaurusResults");
	var divElement = document.createElement("div");
	var labelElement = document.createElement("b");
	var labelText = document.createTextNode(text);
	resultDiv.appendChild(divElement);
	divElement.appendChild(labelElement);
	labelElement.appendChild(labelText);

	divElement.style['marginTop'] = "5px";
}


function findAssociatedTopics(descriptor) {
//	dojo.debug("findAssociatedTopics: "+descriptor.topicId);

	clearThesaurusResults();

	SNSService.getTopicsForTopic(descriptor.topicId, {
		preHook: showLoadingZone,
		postHook: hideLoadingZone,
		callback:function(topic) {
			if (topic.topicId != descriptor.topicId) {
				addResultTextElement("Synonym");
				addDescriptorCheckbox(descriptor, true);
				addResultTextElement("Verwende stattdessen diese Fachbegriffe");
				addDescriptorCheckbox(topic);
			
			} else {
				addResultTextElement("Thesaurus-Schlagwort");
				addDescriptorCheckbox(descriptor, true);
	
				if (topic.synonyms.length > 0) {
					addResultTextElement("Synonyme");
					dojo.lang.forEach(topic.synonyms, function(item){
						addDescriptorCheckbox(item);
					});
				}
	
				if (topic.parents.length > 0) {
					addResultTextElement("Oberbegriffe");
					dojo.lang.forEach(topic.parents, function(item){
						addDescriptorCheckbox(item);
					});
				}
	
				if (topic.children.length > 0) {
					addResultTextElement("Unterbegriffe");
					dojo.lang.forEach(topic.children, function(item){
						addDescriptorCheckbox(item);
					});
				}
			}
			
			dojo.html.show(dojo.byId("objExtSearchAddTopicButtonSpan"));
		},
		timeout:20000,
		errorHandler:function(err) {
			hideLoadingZone();
			dojo.debug("Error while executing SNSService.getTopicsForTopic");
		}
	});
}

// Deletes the checkboxes contained in the div with id: 'objExtSearchThesaurusResults'
function clearThesaurusResults() {
	var resultDiv = dojo.byId("objExtSearchThesaurusResults");

	while (resultDiv.hasChildNodes()) {
		var divElement = resultDiv.removeChild(resultDiv.firstChild);
		var checkBox = divElement.firstChild;
		if (checkBox && checkBox.id) {
			dojo.widget.byId(checkBox.id).destroy();
		}
	}
}

function showNoThesaurusResults() {
	addResultTextElement(message.get("sns.noResultHint"));
	dojo.html.hide(dojo.byId("objExtSearchAddTopicButtonSpan"));
}

// ************************** Thesaurus location Search functions (Raum/Geothesaurus-Raumbezug) **************************
this.findLocationTopics = function() {
	var queryTerm = dojo.string.trim(dojo.widget.byId("objLocationTopic").getValue());

	if (queryTerm.length == 0)
		return;

	clearLocationResults();

	SNSService.getLocationTopics(queryTerm, "exact", {
		preHook: showLoadingZone,
		postHook: hideLoadingZone,
		callback: setLocationResultList,
		timeout: 20000,
		errorHandler: function(err) {
			hideLoadingZone();
			dojo.debug("Error while executing SNSService.getLocationTopics");
		}
	});
}

function setLocationResultList(topicList) {
	if (topicList == null || topicList.length == 0) {
		showNoLocationResults();
		return;
	}

	dojo.html.show(dojo.byId("objExtSearchAddLocationTopicButtonSpan"));

	dojo.lang.forEach(topicList, function(topic) {
		addLocationTopicCheckbox(topic);
	});
}

function addLocationTopicCheckbox(topic) {
	var checkboxDiv = dojo.byId("objExtSearchLocationResults");

	var label = topic.name+", "+topic.type;
	var checkBox = dojo.widget.createWidget("checkbox", {
			id: topic.topicId,
			name: label,
			topic: topic
		});

	var divElement = document.createElement("div");

	var linkElement = document.createElement("a"); 
	linkElement.setAttribute("href", "javascript:void(0);");
	linkElement.topicId = topic.topicId;
	linkElement.onclick = function() {
		findAssociatedLocations(this.topicId);
	}
	linkElement.innerHTML = label;

	checkboxDiv.appendChild(divElement);
	divElement.appendChild(checkBox.domNode);
	divElement.appendChild(linkElement);
}

function findAssociatedLocations(topicId) {
	clearLocationResults();

	SNSService.getLocationTopicsById(topicId, {
		preHook: showLoadingZone,
		postHook: hideLoadingZone,
		callback: setLocationResultList,
		timeout: 20000,
		errorHandler: function(err) {
			hideLoadingZone();
			dojo.debug("Error while executing SNSService.getLocationTopics");
		}
	});	
}

this.addSelectedLocationTopics = function() {
	var resultDiv = dojo.byId("objExtSearchLocationResults");
	var resultStore = dojo.widget.byId("objExtSearchLocationTerms").store;

	dojo.lang.forEach(resultDiv.childNodes, function(divElement) {
		var checkBoxDiv = divElement.firstChild;
		if (checkBoxDiv && checkBoxDiv.id) {
			var checkBox = dojo.widget.byId(checkBoxDiv.id);
		} else {
			return;
		}

		if (checkBox.checked) {
			// If the checked item is already contained in the result list then do nothing
			if (dojo.lang.some(resultStore.getData(), function(item){ return (checkBox.id == item.topicId); }))
				return;

			// Otherwise add the item to the result list
			resultStore.addData( {Id: UtilStore.getNewKey(resultStore), topicId: checkBox.id, title: checkBox.name} );
		}
	});
}


function showNoLocationResults() {
	addLocationResultTextElement(message.get("sns.noResultHint"));
	dojo.html.hide(dojo.byId("objExtSearchAddLocationTopicButtonSpan"));
}

function clearLocationResults() {
	var resultDiv = dojo.byId("objExtSearchLocationResults");

	while (resultDiv.hasChildNodes()) {
		var divElement = resultDiv.removeChild(resultDiv.firstChild);
		var checkBox = divElement.firstChild;
		if (checkBox && checkBox.id) {
			dojo.widget.byId(checkBox.id).destroy();
		}
	}
}

function addLocationResultTextElement(text) {
	var resultDiv = dojo.byId("objExtSearchLocationResults");
	var divElement = document.createElement("div");
	var labelElement = document.createElement("b");
	var labelText = document.createTextNode(text);
	resultDiv.appendChild(divElement);
	divElement.appendChild(labelElement);
	labelElement.appendChild(labelText);

	divElement.style['marginTop'] = "5px";
}

// ************************** Object class functions (Thema/Objektklassen) **************************

// Button function to check all existing object class checkboxes
this.selectAllObjectClasses = function() {
	var checkBoxId = "objTopicObjectClass";

	for (var i = 0; i < 6; ++i) {
		dojo.widget.byId(checkBoxId + i).setValue(true);
	}
}

// Button function to uncheck all existing object class checkboxes
this.deselectAllObjectClasses = function() {
	var checkBoxId = "objTopicObjectClass";

	for (var i = 0; i < 6; ++i) {
		dojo.widget.byId(checkBoxId + i).setValue(false);
	}
}

// ************************** General functions **************************

function showLoadingZone() {
    dojo.html.setVisibility(dojo.byId("objectSearchExtLoadingZone"), "visible");
}

function hideLoadingZone() {
    dojo.html.setVisibility(dojo.byId("objectSearchExtLoadingZone"), "hidden");
}

</script>
</head>

<body>
<!-- EXTENDED SEARCH START -->
<div id="extContentObjContent" class="inputContainer noSpaceBelow">

  <!-- EXTENDED SEARCH TAB CONTAINER START -->
	<div id="obj" dojoType="ingrid:TabContainer" doLayout="false" class="w845" selectedChild="objTopic">
    <!-- EXTENDED SEARCH TAB 1 START -->
		<div id="objTopic" dojoType="ContentPane" class="blueTopBorder grey" label="Thema">
      <!-- EXTENDED SEARCH TAB 1 SUB 1 START -->
		  <div id="objTopic0">
        <div class="tabContainerSubNavi">
    	    <ul>
    	      <li><a nohref="nohref" class="current" title="Suchbegriffe">Suchbegriffe</a></li>
    	      <li><a href="javascript:scriptScope.navInnerTab('objTopic', 1, 3);" title="Objektklassen">Objektklassen</a></li>
    	      <li><a href="javascript:scriptScope.navInnerTab('objTopic', 2, 3);" title="Fachw&ouml;rterbuch">Fachw&ouml;rterbuch</a></li>
    	    </ul>
    	  </div>
        <div class="inputContainer field noSpaceBelow">
          <span class="label"><label for="objTopicInput" onclick="javascript:dialog.showContextHelp(arguments[0], 'Suchbegriff')">Bitte geben Sie die Suchbegriffe ein:</label></span>
          <span class="input spaceBelow"><input type="text" id="objTopicInput" name="objTopicInput" class="w800" dojoType="ingrid:ValidationTextBox" /></span>
          <span class="label"><label class="inActive" for="objTopicInputBoolean">Gesuchtes Objekt enth&auml;lt:</label> <select dojoType="ingrid:Select" style="width:174px;" id="objTopicInputBool" name="objTopicInputBool">
              <!-- TODO: fill in jsp -->
            	<option value="0">Alle diese Begriffe (UND)</option>
            	<option value="1">Einen dieser Begriffe (ODER)</option>
            </select></span>
          <div class="spacerField"></div>
    	  </div>
    	</div>
      <!-- EXTENDED SEARCH TAB 1 SUB 1 END -->
      
      <!-- EXTENDED SEARCH TAB 1 SUB 2 START -->
		  <div id="objTopic1">
        <div class="tabContainerSubNavi">
    	    <ul>
    	      <li><a href="javascript:scriptScope.navInnerTab('objTopic', 0, 3);" title="Suchbegriffe">Suchbegriffe</a></li>
    	      <li><a nohref="nohref" class="current" title="Objektklassen">Objektklassen</a></li>
    	      <li><a href="javascript:scriptScope.navInnerTab('objTopic', 2, 3);" title="Fachw&ouml;rterbuch">Fachw&ouml;rterbuch</a></li>
    	    </ul>
    	  </div>
        <div class="inputContainer field noSpaceBelow">
          <div class="checkboxContainer half">
            <span class="input"><input type="checkbox" name="objTopicObjectClass0" id="objTopicObjectClass0" checked="true" dojoType="Checkbox" /><label class="inActive" for="objTopicObjectClass0">Organisationseinheit/Fachaufgabe</label></span>
            <span class="input"><input type="checkbox" name="objTopicObjectClass1" id="objTopicObjectClass1" checked="true" dojoType="Checkbox" /><label class="inActive" for="objTopicObjectClass1">Geo-Information/Karte</label></span>
            <span class="input noSpaceBelow"><input type="checkbox" name="objTopicObjectClass2" id="objTopicObjectClass2" checked="true" dojoType="Checkbox" /><label class="inActive" for="objTopicObjectClass2">Dokument/Bericht/Literatur</label></span>
          </div>
          <div class="checkboxContainer">
            <span class="input"><input type="checkbox" name="objTopicObjectClass3" id="objTopicObjectClass3" checked="true" dojoType="Checkbox" /><label class="inActive" for="objTopicObjectClass3">Dienst/Anwendung/Informationssystem</label></span>
            <span class="input"><input type="checkbox" name="objTopicObjectClass4" id="objTopicObjectClass4" checked="true" dojoType="Checkbox" /><label class="inActive" for="objTopicObjectClass4">Vorhaben/Projekt/Programm</label></span>
            <span class="input noSpaceBelow"><input type="checkbox" name="objTopicObjectClass5" id="objTopicObjectClass5" checked="true" dojoType="Checkbox" /><label class="inActive" for="objTopicObjectClass5">Datensammlung/Datenbank</label></span>
          </div>
    	</div>
        <div class="spacerField" style="height:28px !important;">

          <span style="float:left;">
	        <button dojoType="ingrid:Button" title="Keine ausw&auml;hlen" onClick="javascript:scriptScope.deselectAllObjectClasses();">Keine ausw&auml;hlen</button>
	      </span>
          <span style="float:left;">
	        <button dojoType="ingrid:Button" title="Alle ausw&auml;hlen" onClick="javascript:scriptScope.selectAllObjectClasses();">Alle ausw&auml;hlen</button>
	      </span>

        </div>
      </div>
      <!-- EXTENDED SEARCH TAB 1 SUB 2 END -->
      
      <!-- EXTENDED SEARCH TAB 1 SUB 3 START -->
	  <div id="objTopic2">
        <div class="tabContainerSubNavi">
    	  <ul>
    	    <li><a href="javascript:scriptScope.navInnerTab('objTopic', 0, 3);" title="Suchbegriffe">Suchbegriffe</a></li>
    	    <li><a href="javascript:scriptScope.navInnerTab('objTopic', 1, 3);" title="Objektklassen">Objektklassen</a></li>
    	    <li><a nohref="nohref" class="current" title="Fachw&ouml;rterbuch">Fachw&ouml;rterbuch</a></li>
    	  </ul>
    	</div>

        <div class="inputContainer field grey noSpaceBelow" style="width:808px;">
          <span class="label"><label for="objTopicThesaurus" onclick="javascript:dialog.showContextHelp(arguments[0], 'Thematischer Fachbegriff')">Bitte geben Sie die Thesaurus-Begriffe an, nach denen gesucht werden soll:</label></span>
          <div class="input spaceBelow">
            <span style="float:left; width:659px;">
              <input type="text" id="objTopicThesaurus" name="objTopicThesaurus" class="w659" dojoType="ingrid:ValidationTextBox" />
			</span>

            <span style="float:right;">
              <button dojoType="ingrid:Button" title="In Thesaurus suchen" onClick="javascript:scriptScope.findTopics();">In Thesaurus suchen</button>
            </span>
          </div>
        </div>

        <div class="inputContainer field grey" style="width:800px; height:200px;">
		  <span class="half" style="float:left;">
<!-- 
            <span class="label"><label for="objExtSearchThesaurusResults" onclick="javascript:dialog.showContextHelp(arguments[0], 'Thesaurus Begriffe')">Ergebnisliste</label></span>
 -->
		    <div id="objExtSearchThesaurusResults" class="h205 checkboxContainer" style="overflow: auto;">
			</div>
		  </span>

	      <span id="objExtSearchAddTopicButtonSpan" style="float:left; margin-top:95px; display:none;">
	        <button dojoType="ingrid:Button" title="&Uuml;bernehmen" onClick="javascript:scriptScope.addSelectedTopics();">&Uuml;bernehmen -&gt;</button>
		  </span>

		  <span style="float:right;">
              <span class="label"><label for="objExtSearchThesaurusTerms" onclick="javascript:dialog.showContextHelp(arguments[0], 'Thesaurus Suchbegriffe')">Suchbegriffe</label></span>
	          <div class="tableContainer spaceBelow headHiddenRows8 w364">
	      	    <table id="objExtSearchThesaurusTerms" dojoType="ingrid:FilteringTable" minRows="8" headClass="hidden" cellspacing="0" class="filteringTable nosort interactive">
	      	      <thead>
	      		      <tr>
	            			<th nosort="true" field="title" dataType="String">Thesaurus Suchbegriffe</th>
	      		      </tr>
	      	      </thead>
	      	      <tbody>
	      	      </tbody>
	      	    </table>
	      	  </div>

            <span class="label">
              <label class="inActive" for="thesaurusTermsRelation">Gesuchtes Objekt enth&auml;lt:</label>
              <select dojoType="ingrid:Select" style="width:174px;" id="thesaurusTermsRelation">
              <!-- TODO: fill in jsp -->
                <option value="0">Alle diese Begriffe (UND)</option>
                <option value="1">Einen dieser Begriffe (ODER)</option>
              </select>
            </span>

		  </span>

		</div>
	    
	    <div class="spacer"></div>
   	  </div>
      <!-- EXTENDED SEARCH TAB 1 SUB 3 END -->
	</div>
    <!-- EXTENDED SEARCH TAB 1 END -->

    <!-- EXTENDED SEARCH TAB 2 START -->
		<div id="objSpace" dojoType="ContentPane" class="blueTopBorder grey" label="Raum">
      <!-- EXTENDED SEARCH TAB 2 SUB 1 START -->
		  <div id="objSpace0">
        <div class="tabContainerSubNavi">
    	    <ul>
    	      <li><a nohref="nohref" class="current" title="Geothesaurus-Raumbezug">Geothesaurus-Raumbezug</a></li>
    	      <li><a href="javascript:scriptScope.navInnerTab('objSpace', 1, 3);" title="Freier Raumbezug">Freier Raumbezug</a></li>
<!-- 
    	      <li><a href="javascript:scriptScope.navInnerTab('objSpace', 2, 3);" title="Raumeinschr&auml;nkung Karte">Raumeinschr&auml;nkung Karte</a></li>
 -->
    	    </ul>
    	  </div>


        <div class="inputContainer field grey noSpaceBelow" style="width:808px;">
          <span class="label"><label for="objLocationTopic" onclick="javascript:dialog.showContextHelp(arguments[0], 'Raumbezug')">Bitte geben Sie die Raumbez&uuml;ge an, nach denen gesucht werden soll:</label></span>
          <div class="input spaceBelow">
            <span style="float:left; width:636px;">
              <input type="text" id="objLocationTopic" class="w636" dojoType="ingrid:ValidationTextBox" />
			</span>

            <span style="float:right;">
              <button dojoType="ingrid:Button" title="In Geo-Thesaurus suchen" onClick="javascript:scriptScope.findLocationTopics();">In Geo-Thesaurus suchen</button>
            </span>
          </div>
        </div>

        <div class="inputContainer field grey" style="width:800px; height:200px;">
		  <span class="half" style="float:left;">
		    <div id="objExtSearchLocationResults" class="h205 checkboxContainer" style="overflow: auto;">
			</div>
		  </span>

	      <span id="objExtSearchAddLocationTopicButtonSpan" style="float:left; margin-top:95px; display:none;">
	        <button dojoType="ingrid:Button" title="&Uuml;bernehmen" onClick="javascript:scriptScope.addSelectedLocationTopics();">&Uuml;bernehmen -&gt;</button>
		  </span>

		  <span style="float:right;">
              <span class="label"><label for="objExtSearchLocationTerms" onclick="javascript:dialog.showContextHelp(arguments[0], 'Geo-Thesaurus Suchbegriffe')">Suchbegriffe</label></span>
	          <div class="tableContainer spaceBelow headHiddenRows8 w364">
	      	    <table id="objExtSearchLocationTerms" dojoType="ingrid:FilteringTable" minRows="8" headClass="hidden" cellspacing="0" class="filteringTable nosort interactive">
	      	      <thead>
	      		      <tr>
	            			<th nosort="true" field="title" dataType="String">Geo-Thesaurus Suchbegriffe</th>
	      		      </tr>
	      	      </thead>
	      	      <tbody>
	      	      </tbody>
	      	    </table>
	      	  </div>

            <span class="label">
              <label class="inActive" for="geoThesaurusTermsRelation">Gesuchtes Objekt enth&auml;lt:</label>
              <select dojoType="ingrid:Select" style="width:174px;" id="geoThesaurusTermsRelation">
              <!-- TODO: fill in jsp -->
                <option value="0">Alle diese Begriffe (UND)</option>
                <option value="1">Einen dieser Begriffe (ODER)</option>
              </select>
            </span>

		  </span>

		</div>

        <div class="spacer"></div>
    	</div>
      <!-- EXTENDED SEARCH TAB 2 SUB 1 END -->
      
      <!-- EXTENDED SEARCH TAB 2 SUB 2 START -->
		  <div id="objSpace1">
        <div class="tabContainerSubNavi">
    	    <ul>
    	      <li><a href="javascript:scriptScope.navInnerTab('objSpace', 0, 3);" title="Geothesaurus-Raumbezug">Geothesaurus-Raumbezug</a></li>
    	      <li><a nohref="nohref" class="current" title="Freier Raumbezug">Freier Raumbezug</a></li>
<!-- 
    	      <li><a href="javascript:scriptScope.navInnerTab('objSpace', 2, 3);" title="Raumeinschr&auml;nkung Karte">Raumeinschr&auml;nkung Karte</a></li>
 -->
    	    </ul>
    	  </div>
        <div class="inputContainer field noSpaceBelow">
          <span class="label"><label for="objSpaceGeoUnit" onclick="javascript:dialog.showContextHelp(arguments[0], 'Freier Raumbezug')">Freier Raumbezug:</label></span>
          <span class="input"><input dojoType="ingrid:Select" listId="1100" style="width:782px;" id="objSpaceGeoUnit" /></span>
    	  </div>
        <div class="spacerField"></div>
    	</div>
      <!-- EXTENDED SEARCH TAB 2 SUB 2 END -->
      
      <!-- EXTENDED SEARCH TAB 2 SUB 3 START -->
		  <div id="objSpace2">
        <div class="tabContainerSubNavi">
    	    <ul>
    	      <li><a href="javascript:scriptScope.navInnerTab('objSpace', 0, 3);" title="Geothesaurus-Raumbezug">Geothesaurus-Raumbezug</a></li>
    	      <li><a href="javascript:scriptScope.navInnerTab('objSpace', 1, 3);" title="Freier Raumbezug">Freier Raumbezug</a></li>
    	      <li><a nohref="nohref" class="current" title="Raumeinschr&auml;nkung Karte">Raumeinschr&auml;nkung Karte</a></li>
    	    </ul>
    	  </div>
        <div class="inputContainer field noSpaceBelow xScroll yNoScroll w829">
          <span><img src="img/map.gif" width="820" height="586" alt="Platzhalter Karte" /></span>
          <div class="spacer"></div>
          <span class="label">Selektiertes Gebiet <strong>Verwaltungseinheit</strong> oder <strong>geogr. Daten</strong></span>
          <div class="spacer"></div>
          <span class="label"><strong>Art der Einschr&auml;nkung</strong></span>
          <div class="checkboxContainer noSpaceBelow">
            <span class="input"><input type="checkbox" name="objSpaceMapConstraint0" widgetId="objSpaceMapConstraint0" dojoType="Checkbox" /><label class="inActive" for="objSpaceMapConstraint0">Der Raumbezug der Ergebnisse liegt innerhalb des gew&auml;hlten Kartenausschnittes</label></span>
            <span class="input"><input type="checkbox" name="objSpaceMapConstraint1" widgetId="objSpaceMapConstraint1" dojoType="Checkbox" /><label class="inActive" for="objSpaceMapConstraint1">Der Raumbezug der Ergebnisse schneidet den gew&auml;hlten Kartenausschnittes</label></span>
            <span class="input"><input type="checkbox" name="objSpaceMapConstraint2" widgetId="objSpaceMapConstraint2" dojoType="Checkbox" /><label class="inActive" for="objSpaceMapConstraint2">Der Raumbezug der Ergebnisse umschlie&szlig;t den gew&auml;hlten Kartenausschnittes</label></span>
          </div>
          <div class="spacerField"></div>
    	  </div>
    	</div>
      <!-- EXTENDED SEARCH TAB 2 SUB 3 END -->
		</div>
    <!-- EXTENDED SEARCH TAB 2 END -->

    <!-- EXTENDED SEARCH TAB 3 START -->
		<div id="objTime" dojoType="ContentPane" class="blueTopBorder grey" label="Zeit">
      <!-- EXTENDED SEARCH TAB 3 SUB 1 START -->
		  <div id="objTime0">
        <div class="tabContainerSubNavi">
    	    <ul>
    	      <li><a nohref="nohref" class="current" title="Zeiteinschr&auml;nkung">Zeiteinschr&auml;nkung</a></li>
    	    </ul>
    	  </div>
        <div class="inputContainer field grey">
          <span class="label"><label onclick="javascript:dialog.showContextHelp(arguments[0], 'Zeitbezug')">Zeitbezug:</label></span>
          <span class="note">Alle Ergebnisse mit Zeitbezug <strong>innerhalb</strong> eingegebenen Zeitraums werden angezeigt:</span>
          <div class="spacer"></div>
          <div class="inputContainer spaceBelow">
            <input type="radio" name="objTimeRef" id="objTimeRef1" class="radio entry first" />
            <label class="inActive entry w033" for="objTimeRef1From">Von:</label>
            <div dojoType="ingrid:DropdownDatePicker" displayFormat="dd.MM.yyyy" toggle="plain" widgetId="objTimeRef1From"></div>
            <label class="inActive" for="objTimeRef1To">Bis:</label>
            <div dojoType="ingrid:DropdownDatePicker" displayFormat="dd.MM.yyyy" toggle="plain" widgetId="objTimeRef1To"></div>
<!-- 
            <label class="inActive entry w033" for="objTimeRef1From">Von:</label>
            <input type="text" id="objTimeRef1From" name="objTimeRef1From" class="w116" dojoType="ingrid:ValidationTextBox" />
            <label class="inActive" for="objTimeRef1To">Bis:</label>
            <input type="text" id="objTimeRef1To" name="objTimeRef1To" class="w116" dojoType="ingrid:ValidationTextBox" />
            <label class="inActive">[TT.MM.JJJJ]</label>
 -->

          </div>
          <div class="inputContainer">
            <input type="radio" name="objTimeRef" id="objTimeRef2" class="radio entry first" />
            <label class="inActive entry w033" for="objTimeRef2On">Am:</label>
            <div dojoType="ingrid:DropdownDatePicker" displayFormat="dd.MM.yyyy" toggle="plain" widgetId="objTimeRef2On"></div>
<!-- 
            <label class="inActive entry w033" for="objTimeRef2On">Am:</label>
            <input type="text" id="objTimeRef2On" name="objTimeRef2On" class="w116" dojoType="ingrid:ValidationTextBox" />
            <label class="inActive">[TT.MM.JJJJ]</label>
 -->
          </div>
          <div class="inputContainer h025">
            <input type="radio" name="objTimeRef" id="objTimeRef3" class="radio entry first" checked />
            <label class="inActive entry" for="objTimeRef3">Kein Zeitbezug</label>
          </div>

          <div class="inputContainer noSpaceBelow">
            <span class="label"><label onclick="javascript:dialog.showContextHelp(arguments[0], 'Erweiterung des Zeitbezuges')">Erweiterung des Zeitbezuges</label></span>
            <div class="checkboxContainer">
              <span class="input"><input type="checkbox" name="objTimeRefExtend1" id="objTimeRefExtend1" dojoType="Checkbox" /><label class="inActive" for="objTimeRefExtend1">Der Zeitbezug der Ergebnisse <strong>schneidet</strong> das eingegebene Suchintervall</label></span>
              <span class="input"><input type="checkbox" name="objTimeRefExtend2" id="objTimeRefExtend2" dojoType="Checkbox" /><label class="inActive" for="objTimeRefExtend2">Der Zeitbezug der Ergebnisse <strong>umschlie&szlig;t</strong> das eingegebene Suchintervall</label></span>
            </div>
          </div>
    	  </div>
        <div class="spacer"></div>
      </div>
      <!-- EXTENDED SEARCH TAB 3 SUB 1 END -->
		</div>
    <!-- EXTENDED SEARCH TAB 3 END -->
	</div>
  <!-- EXTENDED SEARCH TAB CONTAINER END -->

  <div class="inputContainer">
    <span class="button w805" style="height:20px !important;">
      <span style="float:right;">
        <button dojoType="ingrid:Button" title="Suchen" onClick="javascript:scriptScope.startNewSearch();">Suchen</button>
	  </span>
      <span style="float:right;">
        <button dojoType="ingrid:Button" title="Zur&uuml;cksetzen" onClick="javascript:scriptScope.resetInput();">Zur&uuml;cksetzen</button>
	  </span>
	  <span id="objectSearchExtLoadingZone" style="float:left; margin-top:1px; z-index: 100; visibility:hidden">
		<img src="img/ladekreis.gif" />
	  </span>
    </span>
  </div>

    <!-- OBJECT SEARCH RESULT LIST START -->
    <div class="spacer"></div>
    <div id="objectSearchExtResultsContainer" class="inputContainer noSpaceBelow w845">
      <span class="label">Trefferliste</span>
<!-- 
      <span class="functionalLink"><img src="img/ic_fl_save_csv.gif" width="11" height="15" alt="Popup" /><a href="#" title="Trefferliste als CSV-Datei speichern">Trefferliste als CSV-Datei speichern</a></span>
 -->
      <div class="listInfo w845">
        <span id="objSearchExtResultsInfo" class="searchResultsInfo">&nbsp;</span>
        <span id="objSearchExtResultsPaging" class="searchResultsPaging">&nbsp;</span>
    	  <div class="fill"></div>
      </div>

	  <table id="objectSearchExtResults" dojoType="ingrid:FilteringTable" minRows="10" cellspacing="0" class="filteringTable relativePos">
	    <thead>
		  <tr>
      	    <th nosort="true" field="icon" dataType="String" width="23"></th>
      		<th nosort="true" field="linkLabel" dataType="String" width="804">Name</th>
		  </tr>
	    </thead>
        <colgroup>
	      <col width="23">
	      <col width="804">
        </colgroup>
	    <tbody>
	    </tbody>
	  </table>
	</div>
    <!-- OBJECT SEARCH RESULT LIST END -->

<!-- EXTENDED SEARCH END -->
</body>