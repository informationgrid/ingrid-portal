<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de">
<head>
<script type="text/javascript">
var scriptScope = this;

_container_.addOnLoad(function() {
	var language = "de";

	CatalogService.getSysAdditionalFields(null, language, {
		callback: function(additionalFieldList) {
			additionalFieldList.sort(function(a, b) { return (a.id - b.id); });
			var tableData = UtilList.addTableIndices(additionalFieldList);
			dojo.widget.byId("addFieldsList").store.setData(tableData);
		},
		errorHandler: function(msg, err) {
			dojo.debug("Error: "+msg);
			dojo.debugShallow(err);
		}
	});

	var addFieldsList = dojo.widget.byId("addFieldsList");
    var contextMenu = addFieldsList.getContextMenu();
	contextMenu.addSeparator();
    contextMenu.addItemObject( { caption:'Auswahlliste bearbeiten', method:editListEntries } );
	dojo.event.connect("after", contextMenu, "open", function(arg) {
		var rowData = contextMenu.getRowData();
		if (rowData && rowData.type == "LIST") {
			contextMenu.enableItem('Auswahlliste bearbeiten');
		} else {
			contextMenu.disableItem('Auswahlliste bearbeiten');
		} 
	});
});


scriptScope.saveChanges = function() {
	dojo.debug("Function not implemented yet.");
}

scriptScope.addEntry = function() {
	dojo.debug("Function not implemented yet.");
}

function editListEntries(menuItem) {
	var menu = menuItem.parent;
	var rowData = menu.getRowData();
	var listId = rowData.id;
	var listEntries = rowData.listEntries;

	var def = new dojo.Deferred();
	dialog.showPage(
			"Zus&auml;tzliche Felder - Auswahlliste",
			"mdek_admin_catman_additional_fields_list_edit.html",
			502, 245, true,
			{ resultHandler: def, listEntries: listEntries });

	def.addCallback(function(resultList) {
		rowData.listEntries = resultList;
	});

}

</script>
</head>

<body>

<!-- CONTENT START -->
<div dojoType="ContentPane" layoutAlign="client">

	<div id="contentSection" class="contentBlockWhite top">
		<div id="winNavi">
			<a href="#" title="Hilfe">[?]</a>
		</div>
		<div id="catalogueAddFields" class="content">

			<!-- LEFT HAND SIDE CONTENT START -->
			<div class="spacer"></div>
			<div class="spacer"></div>
			<div id="addFields" class="inputContainer w964">

				<div dojoType="ingrid:TableContextMenu" toggle="plain" contextMenuForWindow="false" widgetId="contextMenu1"></div>
				<div class="tableContainer rows20 w964">
					<div class="cellEditors" id="addFieldsListEditors">
						<div dojoType="ingrid:ValidationTextbox" class="w675" widgetId="nameEditor"></div>
						<div dojoType="ingrid:ValidationTextbox" widgetId="numCharsEditor"></div>
		                <select dojoType="ingrid:Select" autoComplete="false" style="width:100px;" id="typeCombobox">
		                	<option value="TEXT">Textfeld</option>
		                	<option value="LIST">Auswahlliste</option>
		                </select>
					</div>
					<table id="addFieldsList" dojoType="ingrid:FilteringTable" minRows="20" cellspacing="0" class="filteringTable nosort interactive">
						<thead>
							<tr>
								<th nosort="true" field="id" dataType="String" width="70">Nr.</th>
								<th nosort="true" field="name" dataType="String" width="724" editor="nameEditor">Feldname</th>
								<th nosort="true" field="size" dataType="String" width="50" editor="numCharsEditor" createOnly="true">Zeichen</th>
								<th nosort="true" field="type" dataType="String" width="120" editor="typeCombobox"  createOnly="true">Typ</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</div>

				<div class="inputContainer">
					<span class="button w924" style="height:20px !important;">
						<span style="float:right;">
							<button dojoType="ingrid:Button" title="Speichern" onClick="javascript:scriptScope.saveChanges();">&Auml;nderung speichern</button>
						</span>
					</span>
				</div>

				<div class="inputContainer grey h067 w964">
					<div class="spacer"></div>
					<div class="entry half left w608" style="margin-right:30px;">
						<span class="label"><label for="addFieldName" onclick="javascript:dialog.showContextHelp(arguments[0], 'Feldname')">Feldname</label></span>
						<span class="input"><input type="text" id="addFieldName" name="addFieldName" class="w608" dojoType="ingrid:ValidationTextBox" /></span>
					</div>
					<div class="entry half left w116" style="margin-right:30px;">
						<span class="label"><label for="addFieldNumChars" onclick="javascript:dialog.showContextHelp(arguments[0], 'Zeichen')">Zeichen</label></span>
						<span class="input"><input type="text" id="addFieldNumChars" name="addFieldNumChars" class="w116" dojoType="ingrid:ValidationTextBox" /></span>
					</div>
					<div class="entry half w116">
						<span class="label"><label for="addFieldNumType" onclick="javascript:dialog.showContextHelp(arguments[0], 'Typ')">Typ</label></span>
						<span class="input">
							<select dojoType="ingrid:Select" toggle="plain" style="width:108px;" widgetId="addFieldNumType">
								<option value="Auswahlliste">Auswahlliste</option>
								<option value="Textfeld">Textfeld</option>
							</select>
						</span>
					</div>
				</div>

				<div class="inputContainer">
					<span class="button w924" style="height:20px !important;">
						<span style="float:right;">
							<button dojoType="ingrid:Button" title="Hinzuf&uuml;gen" onClick="javascript:scriptScope.addEntry();">Hinzuf&uuml;gen</button>
						</span>
					</span>
				</div>

			</div> <!-- LEFT HAND SIDE CONTENT END -->
		</div> <!-- CONTENT END -->
	</div>
</div>

</body>
</html>
